<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Circus Folk</title>
    <link rel="stylesheet" type="text/css" href="style.css" />
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body>
    <nav>
      <ul>
        <li><a href="#Login">Login</a></li>
        <li><a href="https://goo.gl/forms/aDRnDvLxY5iMMFrz2">Sign Up</a></li>
        <li><a href="index.html#Contact">Contact</a></li>
        <li><a href="directory.html">Directory</a></li>
        <li><a href="index.html#About">About</a></li>
        <li><a href="index.html">Home</a></li>
      </ul>
    </nav>
    <main>
      <section id="Directory">
        <img src="img/circusfolklogo.png" alt="logo">
        <h1>Directory</h1>
        <p>Search for performers by name, discipline, talent, apparatus or sort them
        by popularity.
        </p>
        <div class="search-container">
          <form>
            <input id="search" type="text" placeholder="Search.." name="search">
            <button type="submit"><i class="fa fa-search"></i></button>
          </form>
        </div>
      </section>
      <hr>
      <section>
        <div id="profileList">
        </div>
        <script src='https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js'></script>
        <script type="text/javascript">
            function init() {
              Tabletop.init( {
                key: 'https://docs.google.com/spreadsheets/d/13G-vl6Qq4r9avU2Ed-axC1SNTbhBPjEcjGauYxGnPFs/edit?usp=sharing',
                callback: showInfo,
                simpleSheet: true } )
            }

            function filter(searchText) {

            }

            function showInfo(data, tabletop) {
              for(var i = 0; i < data.length; i++) {
                var alias = data[i].Alias;
                var newSrc = data[i].ProfilePicture.replace("open", "uc");
                var talents = data[i].Talents;
                var story = data[i].WhatsYourStory;
                var partOfAustin = data[i].PartOfAustin;
                var timestamp = data[i].Timestamp;
                var spaceIndex = timestamp.indexOf(' ');
                var memberSince = timestamp.slice(0, spaceIndex);
                var phoneNumber = data[i].PhoneNumber;
                var email = data[i].Email;
                var preferredMethod = data[i].PreferredMethodOfContact;


                document.getElementById('profileList').innerHTML += '<div class="entry"><div class="col left"><h2 id="alias"></h2><img id="profilePic"></div><div class="col right"><h3 id="talents"></h3><p id="story"></p><p id="partOfAustin"></p><p id="memberSince"></p><p id="contact"></p></div></div><hr>';
                document.getElementById('profilePic').src = newSrc;
                document.getElementById('alias').innerHTML = alias;
                document.getElementById('talents').innerHTML = "Talents: "+talents;
                document.getElementById('story').innerHTML = "My Story: "+story;
                document.getElementById('partOfAustin').innerHTML = "You can find me in "+partOfAustin;
                document.getElementById('memberSince').innerHTML = "Member Since: "+memberSince;

                if(preferredMethod == 'Text Me') {
                    document.getElementById('contact').innerHTML = "You can text me at "+phoneNumber;
                } else if (preferredMethod == 'Email Me') {
                    document.getElementById('contact').innerHTML = "You can email me at "+email;
                }

              }
            }
            window.addEventListener('DOMContentLoaded', init)
        </script>
      </section>
    </main>
  </body>
</html>
